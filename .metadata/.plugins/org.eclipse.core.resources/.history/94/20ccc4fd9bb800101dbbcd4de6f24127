package com.salesianostriana.dam.libreria.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

import com.salesianostriana.dam.libreria.service.LibroService;
import com.salesianostriana.dam.libreria.model.Libro;
import com.salesianostriana.dam.libreria.model.Categoria;

import java.util.List;

@Controller
public class MainController {

    private final LibroService libroService;
    private final CategoriaService categoriaService;

    // Inyección de dependencias vía constructor
    public MainController(LibroService libroService, CategoriaService categoriaService) {
        this.libroService = libroService;
        this.categoriaService = categoriaService;
    }

    // Página principal
    @GetMapping("/")
    public String welcome(Model model) {
        // Obtener libros destacados (puedes definir el método en tu servicio)
        List<Libro> librosDestacados = libroService.findDestacados();
        // Obtener todas las categorías
        List<Categoria> categorias = categoriaService.findAll();

        // Añadir atributos al modelo para Thymeleaf
        model.addAttribute("librosDestacados", librosDestacados);
        model.addAttribute("categorias", categorias);

        // Devolver el nombre de la plantilla index.html
        return "index";
    }

    // Página de contacto (opcional)
    @GetMapping("/contacto")
    public String contacto() {
        return "contacto"; // plantilla contacto.html
    }
}
